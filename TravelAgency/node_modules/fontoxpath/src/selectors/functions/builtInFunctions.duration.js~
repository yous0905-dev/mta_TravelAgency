import Sequence from '../dataTypes/Sequence';
import createAtomicValue from '../dataTypes/createAtomicValue';
import zipSequences from '../utils/zipSequences';

function fnYearsFromDuration (_dynamicContext, sequence) {
	return zipSequences([sequence], ([durationValue]) => {
		if (durationValue === null) {
			return Sequence.empty();
		}
		return Sequence.singleton(createAtomicValue(durationValue.value.getYears(), 'xs:integer'));
	});
}

function fnMonthsFromDuration (_dynamicContext, sequence) {
	return zipSequences([sequence], ([durationValue]) => {
		if (durationValue === null) {
			return Sequence.empty();
		}
		return Sequence.singleton(createAtomicValue(durationValue.value.getMonths(), 'xs:integer'));
	});
}

function fnDaysFromDuration (_dynamicContext, sequence) {
	return zipSequences([sequence], ([durationValue]) => {
		if (durationValue === null) {
			return Sequence.empty();
		}
		return Sequence.singleton(createAtomicValue(durationValue.value.getDays(), 'xs:integer'));
	});
}

function fnHoursFromDuration (_dynamicContext, sequence) {
	return zipSequences([sequence], ([durationValue]) => {
		if (durationValue === null) {
			return Sequence.empty();
		}
		return Sequence.singleton(createAtomicValue(durationValue.value.getHours(), 'xs:integer'));
	});
}

function fnMinutesFromDuration (_dynamicContext, sequence) {
	return zipSequences([sequence], ([durationValue]) => {
		if (durationValue === null) {
			return Sequence.empty();
		}
		return Sequence.singleton(createAtomicValue(durationValue.value.getMinutes(), 'xs:integer'));
	});
}

function fnSecondsFromDuration (_dynamicContext, sequence) {
	return zipSequences([sequence], ([durationValue]) => {
		if (durationValue === null) {
			return Sequence.empty();
		}
		return Sequence.singleton(createAtomicValue(durationValue.value.getSeconds(), 'xs:decimal'));
	});
}

export default {
	declarations: [
		{
			name: 'years-from-duration',
			argumentTypes: ['xs:duration?'],
			returnType: 'xs:integer?',
			callFunction: fnYearsFromDuration
		},
		{
			name: 'months-from-duration',
			argumentTypes: ['xs:duration?'],
			returnType: 'xs:integer?',
			callFunction: fnMonthsFromDuration
		},
		{
			name: 'days-from-duration',
			argumentTypes: ['xs:duration?'],
			returnType: 'xs:integer?',
			callFunction: fnDaysFromDuration
		},
		{
			name: 'hours-from-duration',
			argumentTypes: ['xs:duration?'],
			returnType: 'xs:integer?',
			callFunction: fnHoursFromDuration
		},
		{
			name: 'minutes-from-duration',
			argumentTypes: ['xs:duration?'],
			returnType: 'xs:integer?',
			callFunction: fnMinutesFromDuration
		},
		{
			name: 'seconds-from-duration',
			argumentTypes: ['xs:duration?'],
			returnType: 'xs:decimal?',
			callFunction: fnSecondsFromDuration
		}
	]
};
